# Pass rules - traffic will not be inspected. Use carefuly. What I want to whitelist actally goes the other way, but would not have a http_host in a reverse direction so matching entire flow.
# These rules will make the matched traffic bypass entire detection engine, use sparingly
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"windowsupdate.com"; http_host; isdataat:!1,relative; sid:9000001; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"windowsupdate.com"; http_host; isdataat:!1,relative; sid:9000002; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"download.gfe.nvidia.com"; http_host; isdataat:!1,relative; sid:9000003; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"download.gfe.nvidia.com"; http_host; isdataat:!1,relative; sid:9000004; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"download-cdn.gfe.nvidia.com"; http_host; isdataat:!1,relative; sid:9000005; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"download-cdn.gfe.nvidia.com"; http_host; isdataat:!1,relative; sid:9000006; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"download.skype.com"; http_host; isdataat:!1,relative; sid:9000007; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"download.skype.com"; http_host; isdataat:!1,relative; sid:9000008; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"download.windowsupdate.com"; http_host; isdataat:!1,relative; sid:9000009; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"download.windowsupdate.com"; http_host; isdataat:!1,relative; sid:9000010; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"au.download.windowsupdate.com"; http_host; isdataat:!1,relative; sid:9000011; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"au.download.windowsupdate.com"; http_host; isdataat:!1,relative; sid:9000012; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"msdl.microsoft.com"; http_host; isdataat:!1,relative; sid:90000013; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"msdl.microsoft.com"; http_host; isdataat:!1,relative; sid:9000014; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"symbols.mozilla.org"; http_host; isdataat:!1,relative; sid:9000015; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"symbols.mozilla.org"; http_host; isdataat:!1,relative; sid:9000016; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"archive.mozilla.org"; http_host; isdataat:!1,relative; sid:9000017; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"archive.mozilla.org"; http_host; isdataat:!1,relative; sid:9000018; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"support.content.office.microsoft.com"; http_host; isdataat:!1,relative; sid:9000019; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"support.content.office.microsoft.com"; http_host; isdataat:!1,relative; sid:9000020; rev:1;)
pass http $HOME_NET any -> $REALLY_EXTERNAL_NET any (flow:established,to_server; content:"download.cdn.mozilla.net"; http_host; isdataat:!1,relative; sid:9000021; rev:1;)
pass http $HOME_NET any -> $PROXY_SERVERS any (flow:established,to_server; content:"download.cdn.mozilla.net"; http_host; isdataat:!1,relative; sid:9000022; rev:1;)
# ET USER_AGENTS Go
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/1.1"; nocase; http_user_agent; fast_pattern; content:"api.mig.mozilla.org"; http_host; sid:9000025; rev:1;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/2.0"; nocase; http_user_agent; fast_pattern; content:"hg.mozilla.org"; http_host; sid:9000026; rev:1;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/1.1"; nocase; http_user_agent; fast_pattern; content:"security-tracker.debian.org"; http_host; sid:9000027; rev:1;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/1.1"; nocase; http_user_agent; fast_pattern; content:"linux.oracle.com"; http_host; sid:9000028; rev:1;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/1.1"; nocase; http_user_agent; fast_pattern; content:"www.redhat.com"; http_host; sid:9000029; rev:1;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/1.1"; nocase; http_user_agent; fast_pattern; content:"nvd.nist.gov"; http_host; sid:9000030; rev:1;)
pass http $HOME_NET any -> $EXTERNAL_NET any (flow:established,to_server; content:"Go-http-client/1.1"; nocase; http_user_agent; fast_pattern; content:"static.nvd.nist.gov"; http_host; sid:9000031; rev:1;)

